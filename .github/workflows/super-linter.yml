# Run GitHub Super-Linter to validate the codebase.
name: â™» super-linter

on:
  workflow_call:
    inputs:
      runs_on:
        description: The label of the runner (GitHub- or self-hosted) to run this workflow on. Defaults to `ubuntu-24.04`.
        type: string
        required: false
        default: ubuntu-24.04

      filter_regex_exclude:
        description: Exclude files from linting using a regex pattern.
        type: string
        required: false

      filter_regex_include:
        description: Include files in linting using a regex pattern.
        type: string
        required: false

permissions: {}

jobs:
  super-linter:
    name: Super-linter
    runs-on: ${{ inputs.runs_on }}
    permissions:
      contents: read # Required to checkout the repository
    steps:
      - name: Checkout
        uses: actions/checkout@de0fac2e4500dabe0009e67214ff5f5447ce83dd # v6.0.2
        with:
          fetch-depth: 0 # Required to get the list of files that changed across commits
          persist-credentials: false

      - name: Run Super-linter
        uses: super-linter/super-linter@d5b0a2ab116623730dd094f15ddc1b6b25bf7b99 # v8.3.2
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          FILTER_REGEX_EXCLUDE: ${{ inputs.filter_regex_exclude }}
          FILTER_REGEX_INCLUDE: ${{ inputs.filter_regex_include }}
          # If triggered by PR, only validate changed files.
          VALIDATE_ALL_CODEBASE: ${{ github.event_name != 'pull_request' }}
          # Don't create status checks per linter.
          # Create GitHub Actions job summary instead.
          MULTI_STATUS: false
          ENABLE_GITHUB_ACTIONS_STEP_SUMMARY: true

          # For Python, prefer the Ruff linter and code formatter over Flake8,
          # isort and Black. Ruff is faster than, has feature parity with, and
          # serves as a drop-in replacement for these tools.
          # Ref: https://docs.astral.sh/ruff/
          VALIDATE_PYTHON_RUFF: true
          VALIDATE_PYTHON_RUFF_FORMAT: true

          VALIDATE_BASH: true
          VALIDATE_POWERSHELL: true

          VALIDATE_JSON: true
          VALIDATE_YAML: true

          VALIDATE_MARKDOWN: true

          VALIDATE_GITHUB_ACTIONS: true
