# Run GitHub Super-Linter to validate the codebase.
name: â™» super-linter

on:
  workflow_call:
    inputs:
      runs_on:
        description: The label of the runner (GitHub- or self-hosted) to run this workflow on. Defaults to `ubuntu-24.04`.
        type: string
        required: false
        default: ubuntu-24.04

      filter_regex_exclude:
        description: Exclude files from linting using a regex pattern.
        type: string
        required: false

      filter_regex_include:
        description: Include files in linting using a regex pattern.
        type: string
        required: false

permissions: {}

jobs:
  super-linter:
    name: Super-linter
    runs-on: ${{ inputs.runs_on }}
    permissions:
      contents: read # Required to checkout the repository
    steps:
      - name: Checkout
        uses: actions/checkout@08c6903cd8c0fde910a37f88322edcfb5dd907a8
        with:
          fetch-depth: 0 # Required to get the list of files that changed across commits
          persist-credentials: false

      - name: Lint Codebase
        uses: super-linter/super-linter@7bba2eeb89d01dc9bfd93c497477a57e72c83240
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          FILTER_REGEX_EXCLUDE: ${{ inputs.filter_regex_exclude }}
          FILTER_REGEX_INCLUDE: ${{ inputs.filter_regex_include }}

          # Don't create status checks per linter.
          # Create GitHub Actions job summary instead.
          MULTI_STATUS: false
          ENABLE_GITHUB_ACTIONS_STEP_SUMMARY: true

          # If triggered by PR, only validate changed files.
          VALIDATE_ALL_CODEBASE: ${{ github.event_name != 'pull_request' }}

          VALIDATE_CSHARP: true
          VALIDATE_DOTNET_SLN_FORMAT_ANALYZERS: true
          VALIDATE_DOTNET_SLN_FORMAT_STYLE: true
          VALIDATE_DOTNET_SLN_FORMAT_WHITESPACE: true

          VALIDATE_HTML: true

          VALIDATE_CSS: true

          VALIDATE_JAVASCRIPT_ES: true
          VALIDATE_JAVASCRIPT_PRETTIER: true
          VALIDATE_TYPESCRIPT_ES: true
          VALIDATE_TYPESCRIPT_PRETTIER: true

          # Common in both Node.js and ASP.NET projects
          VALIDATE_EDITORCONFIG: true

          # For Python, prefer the Ruff linter over Flake8 and isort.
          # The Ruff linter is faster than, has feature parity with, and serves as a drop-in replacement for both Flake8 and isort.
          # The Ruff formatter also has feature parity with Black, however Super-linter does not yet support the Ruff formatter.
          # Ref: https://docs.astral.sh/ruff/
          VALIDATE_PYTHON_RUFF: true
          VALIDATE_PYTHON_RUFF_FORMAT: true
          VALIDATE_PYTHON_MYPY: true

          VALIDATE_BASH: true

          VALIDATE_POWERSHELL: true

          VALIDATE_GITHUB_ACTIONS: true
          VALIDATE_GITHUB_ACTIONS_ZIZMOR: true

          VALIDATE_TERRAFORM_FMT: true
          VALIDATE_TERRAFORM_TFLINT: true

          VALIDATE_JSON: true
          VALIDATE_YAML: true

          VALIDATE_MARKDOWN: true
